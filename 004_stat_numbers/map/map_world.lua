function CreateWorldMap(state)

  local id = "world"
  local worldState = state.maps[id]

  local encountersWorld =
  {
      -- 1. yellow / plains
      {
          {
              oddment = 100,
              item = {}
          },
          {
              oddment = 3,
              item =
              {
                  background = "combat_bg_field.png",
                  enemy =
                  {
                    "goblin_field",
                    "goblin_field",
                    "goblin_field",
                  }
              }
          }
      },
      -- 2.pink - pass
      {
          {
              oddment = 100,
              item = {}
          },
          {
              oddment = 10,
              item =
              {
                  background = "combat_bg_field.png",
                  enemy =
                  {
                      "goblin_forest",
                      "goblin_forest",
                      "goblin_forest",
                  }
              }
          }
      },
      -- 3. blue / forest pass
      {
          {
              oddment = 100,
              item = {}
          },
          {
              oddment = 3,
              item =
              {
                  background = "combat_bg_field.png",
                  enemy =
                  {
                      "goblin_field",
                      "goblin_forest",
                      "goblin_field",
                  }
              }
          },
          {
              oddment = 20,
              item =
              {
                  background = "combat_bg_forest.png",
                  enemy =
                  {
                      "goblin_forest",
                      "goblin_field",
                      "goblin_forest",
                  }
              }
          }
      }
  }


  return
  {
    id = id,
    name = "World",
    can_save = true,
    version = "1.1",
    luaversion = "5.1",
    orientation = "orthogonal",
    width = 30,
    height = 30,
    tilewidth = 16,
    tileheight = 16,
    properties = {},
    encounters = encountersWorld,
    on_wake =
    {

    },
    actions =
    {
        to_town = { id = "ChangeMap", params = { "town", 1, 106 } },
        to_cave = { id = "ChangeMap", params = { "cave", 12, 110 } },
    },
    trigger_types =
    {
        enter_town = { OnEnter = "to_town"},
        enter_cave = { OnEnter = "to_cave"},
    },
    triggers =
    {
        { trigger = "enter_town", x = 7, y = 26 },
        { trigger = "enter_cave", x = 23, y = 3 },
    },
    tilesets = {
      {
        name = "world_tileset",
        firstgid = 1,
        tilewidth = 16,
        tileheight = 16,
        spacing = 0,
        margin = 0,
        image = "world_tileset.png",
        imagewidth = 128,
        imageheight = 128,
        properties = {},
        tiles = {}
      },
      {
        name = "collision_graphic",
        firstgid = 65,
        tilewidth = 16,
        tileheight = 16,
        spacing = 0,
        margin = 0,
        image = "collision_graphic.png",
        imagewidth = 32,
        imageheight = 32,
        properties = {},
        tiles = {}
      },
      {
        name = "encounter_palette",
        firstgid = 69,
        tilewidth = 16,
        tileheight = 16,
        spacing = 0,
        margin = 0,
        image = "../../quests-9-solution/encounter_palette.png",
        imagewidth = 128,
        imageheight = 128,
        properties = {},
        tiles = {}
      }
    },
 layers = {
    {
      type = "tilelayer",
      name = "0-background",
      x = 0,
      y = 0,
      width = 30,
      height = 30,
      visible = true,
      opacity = 1,
      properties = {},
      encoding = "lua",
      data = {
        55, 55, 56, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 55, 56,
        63, 63, 64, 55, 56, 55, 56, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 55, 56, 63, 64,
        55, 56, 58, 63, 64, 63, 64, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 63, 64, 55, 56,
        63, 64, 55, 56, 55, 56, 58, 58, 58, 58, 58, 58, 58, 58, 58, 58, 53, 58, 58, 58, 58, 58, 58, 47, 53, 58, 58, 58, 63, 64,
        58, 58, 63, 55, 56, 64, 58, 58, 58, 58, 58, 58, 58, 58, 58, 54, 24, 52, 58, 58, 54, 52, 54, 8, 24, 52, 53, 58, 58, 58,
        55, 56, 58, 63, 64, 58, 58, 58, 58, 53, 53, 53, 53, 53, 54, 25, 26, 27, 52, 54, 25, 34, 26, 26, 26, 26, 27, 52, 58, 58,
        63, 64, 55, 56, 58, 58, 58, 58, 54, 24, 24, 24, 24, 25, 26, 34, 34, 34, 26, 26, 34, 34, 34, 34, 34, 34, 34, 27, 57, 58,
        58, 58, 63, 64, 58, 58, 58, 59, 24, 24, 24, 24, 24, 33, 34, 34, 42, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 35, 57, 58,
        58, 58, 58, 58, 58, 58, 58, 59, 24, 10, 20, 9, 24, 41, 42, 43, 24, 41, 34, 34, 43, 41, 34, 34, 34, 34, 34, 43, 58, 58,
        58, 58, 58, 58, 58, 58, 58, 59, 24, 22, 19, 21, 24, 24, 24, 24, 24, 24, 41, 43, 24, 24, 41, 42, 42, 42, 43, 24, 52, 58,
        58, 58, 58, 58, 58, 58, 58, 59, 24, 2, 23, 1, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 16, 24, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 58, 58, 58, 54, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 52,
        58, 58, 58, 58, 58, 58, 59, 25, 26, 26, 26, 26, 27, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 49,
        58, 58, 58, 58, 58, 58, 59, 33, 34, 34, 34, 34, 34, 26, 27, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 49, 58,
        58, 58, 58, 58, 58, 58, 54, 34, 34, 34, 34, 34, 34, 34, 34, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 52, 58,
        58, 58, 58, 58, 58, 54, 25, 34, 34, 34, 34, 34, 34, 34, 43, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 59, 25, 34, 34, 34, 34, 34, 34, 34, 34, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 59, 41, 42, 42, 42, 42, 42, 42, 42, 43, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 58, 51, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 58, 59, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 26, 26, 26, 27, 25, 26, 26, 26, 27, 24, 24, 24, 24, 57,
        58, 58, 58, 58, 58, 59, 24, 24, 24, 24, 24, 24, 24, 24, 24, 33, 34, 34, 34, 34, 34, 34, 34, 34, 35, 24, 24, 24, 24, 52,
        58, 58, 58, 58, 58, 59, 24, 24, 24, 24, 24, 24, 24, 24, 24, 33, 34, 34, 34, 34, 34, 34, 42, 42, 43, 24, 24, 24, 24, 10,
        58, 58, 58, 58, 58, 59, 24, 24, 24, 24, 24, 24, 24, 24, 24, 33, 34, 34, 34, 34, 34, 34, 27, 24, 24, 24, 24, 24, 24, 22,
        58, 58, 58, 58, 58, 54, 24, 24, 24, 24, 24, 24, 24, 24, 24, 33, 34, 34, 34, 34, 34, 34, 35, 24, 24, 24, 24, 24, 10, 4,
        58, 58, 58, 58, 58, 51, 24, 24, 24, 10, 20, 9, 24, 24, 24, 41, 34, 34, 34, 34, 34, 34, 35, 24, 24, 24, 24, 10, 4, 19,
        58, 55, 56, 58, 58, 59, 24, 24, 24, 22, 19, 21, 24, 24, 24, 24, 41, 42, 42, 43, 41, 42, 43, 24, 24, 24, 24, 22, 19, 19,
        58, 63, 64, 58, 58, 59, 24, 48, 10, 4, 19, 21, 24, 24, 10, 20, 20, 20, 20, 20, 9, 24, 24, 24, 24, 24, 10, 4, 19, 19,
        55, 56, 58, 58, 58, 58, 51, 24, 2, 23, 6, 3, 20, 20, 4, 19, 19, 19, 19, 19, 3, 20, 20, 20, 20, 20, 4, 19, 19, 19,
        63, 55, 56, 58, 58, 58, 54, 10, 20, 20, 4, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19,
        58, 63, 64, 58, 58, 54, 10, 4, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19
      }
    },
    {
      type = "tilelayer",
      name = "1-detail",
      x = 0,
      y = 0,
      width = 30,
      height = 30,
      visible = true,
      opacity = 1,
      properties = {},
      encoding = "lua",
      data = {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
      }
    },
    {
      type = "tilelayer",
      name = "2-collision",
      x = 0,
      y = 0,
      width = 30,
      height = 30,
      visible = true,
      opacity = 0.36,
      properties = {},
      encoding = "lua",
      data = {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65, 65, 65, 65, 65, 65, 65, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 65, 65, 65, 65, 65, 65, 65, 65, 0, 65, 65, 65, 65, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 65, 0, 0, 0, 0, 0, 65, 68, 0, 65, 65, 65, 65, 65, 65, 0, 0, 65, 65, 65, 65, 65,
        0, 0, 0, 0, 0, 0, 0, 0, 65, 65, 65, 65, 65, 65, 65, 0, 68, 0, 65, 65, 68, 0, 68, 0, 68, 0, 68, 65, 65, 65,
        0, 0, 0, 0, 0, 0, 0, 65, 65, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 0, 0, 68, 0, 68, 65, 65,
        0, 0, 0, 0, 0, 0, 0, 65, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 65, 65,
        0, 0, 0, 0, 0, 0, 0, 65, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 0, 0, 68, 0, 68, 65, 65,
        0, 0, 0, 0, 0, 0, 65, 65, 66, 0, 65, 0, 66, 0, 66, 0, 66, 0, 68, 0, 66, 0, 68, 0, 68, 68, 68, 66, 65, 65,
        0, 0, 0, 0, 0, 0, 65, 65, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 0, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 0, 0, 65, 65, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 0, 0, 65, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 0, 0, 65, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 65, 65,
        0, 0, 0, 0, 0, 65, 65, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 65, 65,
        0, 0, 0, 0, 65, 65, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 67, 0, 67, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 65, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 67, 0, 67, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 65, 0, 68, 0, 68, 0, 68, 0, 68, 0, 67, 0, 67, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 65, 65, 0, 66, 0, 66, 0, 67, 0, 67, 0, 67, 0, 67, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 0, 65, 66, 0, 66, 0, 66, 0, 66, 0, 67, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 0, 65, 0, 66, 0, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 0, 65, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 0, 65, 0, 66, 0, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 0, 65,
        0, 0, 0, 0, 0, 65, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 65,
        0, 0, 0, 0, 0, 65, 0, 66, 0, 66, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 0, 66, 65, 65,
        0, 0, 0, 0, 0, 65, 66, 0, 66, 0, 65, 0, 66, 0, 66, 0, 68, 0, 68, 0, 68, 0, 68, 0, 66, 0, 66, 65, 65, 65,
        0, 0, 0, 0, 0, 65, 0, 0, 0, 65, 65, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 66, 0, 65, 65, 65,
        0, 0, 0, 0, 0, 65, 65, 0, 66, 0, 65, 65, 66, 0, 65, 65, 65, 65, 65, 65, 65, 0, 66, 0, 66, 0, 65, 65, 65, 65,
        0, 0, 0, 0, 0, 65, 65, 66, 0, 66, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65,
        0, 0, 0, 0, 65, 65, 66, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65
      }
    }
  }
}
end